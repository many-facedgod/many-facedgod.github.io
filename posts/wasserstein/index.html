<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.5.1"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="The Kantorovich-Rubinstein duality" /><meta name="author" content="Tanmaya Shekhar Dabral" /><meta property="og:locale" content="en_US" /><meta name="description" content="In this post we’ll talk about the Wasserstein-1 distance, which is a metric on the space of probability distributions, and the Kantorovich-Rubinstein duality, which establishes an elegant and rather useful dual for it. One of the many good things about this metric is that in many cases it yields nicer gradients when compared to other divergences like the Jensen-Shannon divergence. For this reason, the Wasserstein-GAN [Arjovsky et al. 2017] trains the generator to minimize a loss that loosely mimics the W-1 distance between the model’s distribution and the target distribution. Calculating W-1 distance itself can be formulated as an optimization problem and therefore it also admits a dual which in fact, the critic in the W-GAN tries to approximately solve. As we shall see, the primal form is a pretty straightforward consequence of the definition, but the dual form requires some work to intuit." /><meta property="og:description" content="In this post we’ll talk about the Wasserstein-1 distance, which is a metric on the space of probability distributions, and the Kantorovich-Rubinstein duality, which establishes an elegant and rather useful dual for it. One of the many good things about this metric is that in many cases it yields nicer gradients when compared to other divergences like the Jensen-Shannon divergence. For this reason, the Wasserstein-GAN [Arjovsky et al. 2017] trains the generator to minimize a loss that loosely mimics the W-1 distance between the model’s distribution and the target distribution. Calculating W-1 distance itself can be formulated as an optimization problem and therefore it also admits a dual which in fact, the critic in the W-GAN tries to approximately solve. As we shall see, the primal form is a pretty straightforward consequence of the definition, but the dual form requires some work to intuit." /><link rel="canonical" href="https://many-facedgod.github.io/posts/wasserstein/" /><meta property="og:url" content="https://many-facedgod.github.io/posts/wasserstein/" /><meta property="og:site_name" content="VanillaBug" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-28T09:31:00-04:00" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"The Kantorovich-Rubinstein duality","dateModified":"2020-05-28T09:31:00-04:00","datePublished":"2020-05-28T09:31:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://many-facedgod.github.io/posts/wasserstein/"},"url":"https://many-facedgod.github.io/posts/wasserstein/","author":{"@type":"Person","name":"Tanmaya Shekhar Dabral"},"description":"In this post we’ll talk about the Wasserstein-1 distance, which is a metric on the space of probability distributions, and the Kantorovich-Rubinstein duality, which establishes an elegant and rather useful dual for it. One of the many good things about this metric is that in many cases it yields nicer gradients when compared to other divergences like the Jensen-Shannon divergence. For this reason, the Wasserstein-GAN [Arjovsky et al. 2017] trains the generator to minimize a loss that loosely mimics the W-1 distance between the model’s distribution and the target distribution. Calculating W-1 distance itself can be formulated as an optimization problem and therefore it also admits a dual which in fact, the critic in the W-GAN tries to approximately solve. As we shall see, the primal form is a pretty straightforward consequence of the definition, but the dual form requires some work to intuit.","@context":"https://schema.org"}</script><title>The Kantorovich-Rubinstein duality | VanillaBug</title><link rel="shortcut icon" href="/assets/images/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/images/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/images/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/images/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/images/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/images/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/images/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/images/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/images/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/images/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/images/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/images/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/images/favicons/manifest.json"><meta name='msapplication-config' content='/assets/images/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/images/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script type="text/javascript"> window.MathJax = { tex: { packages: {'[+]': ['base', 'ams', 'boldsymbol']}, inlineMath: [['$', '$'], ['\\(', '\\)']] }, loader: { load: ['ui/menu', '[tex]/ams', '[tex]/boldsymbol'] }, startup: { ready() { MathJax.startup.defaultReady(); const Macro = MathJax._.input.tex.Symbol.Macro; const MapHandler = MathJax._.input.tex.MapHandler.MapHandler; const Array = MathJax._.input.tex.ams.AmsMethods.default.Array; const env = new Macro('psmallmatrix', Array, [null, '(', ')', 'c', '.333em', '.2em', 'S', 1]); MapHandler.getMap('AMSmath-environment').add('psmallmatrix', env); } } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script defer src="/app.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/images/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">VanillaBug</a></div><div class="site-subtitle font-italic">A website for things.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { this.setLight(); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); </script> </span> <a href="https://github.com/many-facedgod" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tanmaya.dabral','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/tdabral/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>The Kantorovich-Rubinstein duality</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>The Kantorovich-Rubinstein duality</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, May 28, 2020, 9:31 AM -0400" > May 28, 2020 <i class="unloaded">2020-05-28T09:31:00-04:00</i> </span> by <span class="author"> Tanmaya Shekhar Dabral </span></div></div><div class="post-content"><p>In this post we’ll talk about the Wasserstein-1 distance, which is a metric on the space of probability distributions, and the Kantorovich-Rubinstein duality, which establishes an elegant and rather useful dual for it. One of the many good things about this metric is that in many cases it yields nicer gradients when compared to other divergences like the Jensen-Shannon divergence. For this reason, the Wasserstein-GAN <a class="citation" href="#arjovsky2017wasserstein">[Arjovsky et al. 2017]</a> trains the generator to minimize a loss that loosely mimics the W-1 distance between the model’s distribution and the target distribution. Calculating W-1 distance itself can be formulated as an optimization problem and therefore it also admits a dual which in fact, the critic in the W-GAN tries to approximately solve. As we shall see, the primal form is a pretty straightforward consequence of the definition, but the dual form requires some work to intuit.</p><p>This article presents the idea in the paper “On Translocation of Masses” by L. Kantorovich <a class="citation" href="#kantorovich1942translocation">[Kantorovich 1942]</a> which is pretty neat, if a bit too terse. It also borrows a bit from C. Villani’s “Optimal Transport, Old and New” <a class="citation" href="#villani2008optimal">[Villani 2008]</a>. The first section of this post introduces the idea behind the Wasserstein metric in its primal form and the second one formulates the dual problem from the primal without invoking any LP-duality magic to foster a better 𝓲𝓷𝓽𝓾𝓲𝓽𝓲𝓸𝓷™. Throughout the article we only look at discrete distributions and offer a silent yet heartfelt prayer to the gods of separability and hope it generalizes to distributions on $\mathbb{R}^n$.</p><h2 id="the-wasserstein-1-metric">The Wasserstein-1 metric</h2><p>In a land far, far away, the enigmatic kingdom of Paradis Island has a set of cities $\mathcal{C}={c_1, c_2, c_3, …}$. The distance between any two of these cities $c_i$ and $c_j$ is $d(c_i, c_j)$, where $d$ is a <a href="https://en.wikipedia.org/wiki/Metric_(mathematics)"><em>metric</em></a> on $\mathcal{C}$. That is, it’s a non-negative, symmetric function that’s zero iff $i=j$ and follows the <a href="https://en.wikipedia.org/wiki/Triangle_inequality">triangle inequality</a>. You know, all things that make distances distance-like. The cities cumulatively produce a single metric ton of potatoes, with each city $c$ producing $p(c)$ metric tons of the tasty taters. Unfortunately, the demand for the succulent spuds across the cities is not the same as $p$. Instead, the demand in a city $c$ is given by $q(c)$. Thankfully, Paradis is self-sufficient and the total demand is the same as the total supply, i.e., one metric ton.</p><p>King Fritz has hired the Reeves transportation company to redistribute the tantalizing tubers to deal with this incongruity between the supply and the demand. The price they charge for transporting $m$ metric tons of the yummy yams from city $c_i$ to city $c_j$ is, understandably, $m\cdot d(c_i, c_j)$. The King hires us to come up with an optimal transportation plan that minimizes the burden on the royal treasury. This minimal cost is what’s called the Wasserstein-1 distance.</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/potatoes.jpg" alt="I now have a newfound appreciation for the layers in Sasha's hair." title="I now have a newfound appreciation for the layers in Sasha's hair." style="width:40%;" /></center><p>But what does a transportation plan look like? The transportation company requires instructions of the form “transport $m_{i,j}$ units from $c_i$ to $c_j$” for each ordered pair of cities $c_i, c_j$. Additionally, all these instructions are carried out at the same time. So if a city $c$ originally had $m$ metric tons of the appetizing aloos (really scraping the bottom of the barrel here), it cannot send out more than $m$ units to other cities even if it has some potatoes incoming according to the plan. Of course, this restriction doesn’t change the minimal cost (why?). However, it does constrain the kind of instructions we can send over to our friends over at Reeves: the total mass going out of (or unmoved from) a city must be equal to the supply $p(c)$, and the total mass coming into (or unmoved from) a city must be equal to its demand $q(c)$.</p><p>As you might have noticed, $p$ and $q$ represent probability distributions over $\mathcal{C}$. Let $\gamma$, a non-negative function over $\mathcal{C}\times\mathcal{C}$, be a valid transportation plan that we come up with such that $\gamma(c_i, c_j)$ tells us the amount of mass that must be transported from city $c_i$to $c_j$ with $\gamma(c, c)$ for any city $c$ representing how much of the mass is unmoved. Any valid plan must follow the following two equalities, corresponding to the two constraints we formulated earlier:</p>\[\begin{aligned} \sum_{u \in \mathcal{C}}\gamma(c, u) = p(c) \,\forall c \in \mathcal{C}\\ \sum_{u \in \mathcal{C}}\gamma(u, c) = q(c) \,\forall c \in \mathcal{C} \end{aligned}\]<p>The equalities also imply:</p>\[\sum_{c_i, c_j \in \mathcal{C}}\gamma(c_i, c_j) = 1\]<p>Like mentioned before, another constraint is that of non-negativity. After all, you cannot transport negative mass:</p>\[\gamma(c_i, c_j) \geq 0 \, \forall c_i, c_j \in \mathcal{C}\]<p>All these together imply that any valid plan is, in fact, a distribution on $\mathcal{C} \times \mathcal{C}$ with its two marginal distributions being $p$ and $q$. What then, is the total cost that we incur given a valid plan? It is, by definition:</p>\[\begin{aligned} C_d(\gamma) &amp;= \sum_{c_i, c_j \in \mathcal{C}}\gamma(c_i, c_j)d(c_i, c_j)\\ &amp;= \mathbb{E}_{c_i, c_j \sim \gamma}[d(c_i, c_j)] \end{aligned}\]<p>where the subscript $d$ ties the cost to the specific metric over $\mathcal{C}$ being used. Let $\Gamma_{p, q}$ be the set of all valid plans following the constraints listed earlier. Then, we can define the Wasserstein-1 distance between $p$ and $q$ as the cost of the cheapest transportation plan that converts $p$ into $q$:</p>\[W(p, q) = \min_{\gamma \in \Gamma_{p, q}}C_d(\gamma)\\\]<p>Indeed, this is the primal form of the Wasserstein distance.</p><p>Before we move any further, we should convince ourselves that $W$ is, in fact, a <a href="https://en.wikipedia.org/wiki/Metric_(mathematics)">metric</a> on the set of probability distributions on $\mathcal{C}$ and the introduction was not a lie. The non-negativity and the <a href="https://en.wikipedia.org/wiki/Identity_of_indiscernibles">identity of indiscernibles</a> (that is, $W(p, q) = 0 \iff p = q$) are easy to see given the fact that $d$ itself is a metric. It is also apparent that $W$ should be symmetric, since transforming $q$ to $p$ is equivalent to transforming $p$ to $q$ if we just reverse the arrow of time. Finally, the triangle inequality can be thought of as a consequence of the fact that $W$ is supposed to be the cost associated with the <em>cheapest</em> transportation plan. After all, if $W(p, q) \leq W(p, r) + W(r, q)$ did not hold for some distribution $r$, we could always transform $p$ to $q$ by first transforming $p$ to $r$ and then transforming $r$ to $q$ and incur a smaller cost, contradicting our optimality condition for $W(p, q)$ (some hand-waving here, but it’s not that difficult to figure out).</p><h2 id="the-optimal-plan">The Optimal Plan</h2><p>First of all, a trivial observation is that the optimal plan $\gamma^*$ may not be unique. Consider the example of points $A, B, C$ and $D$ forming a square:</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/square_plan.jpg" style="width:75%;" /></center><p>The edges represent the plan, with the numbers in red representing the amount of mass being transferred. The blue and the green numbers next to the nodes represent $p(c)$ and $q(c)$ respectively.</p><p>Both these plans can be easily verified to have the same (and optimal) cost. Clearly, it doesn’t matter how we match the deficits in $B$ and $C$ with the excesses in $A$ and $D$ since the distance covered is the same either way. Now the good ol’ King doesn’t really care about what plan we come up with as long as it’s optimal, so all we need to do is come up with <em>one</em> optimal plan.</p><p>Inspired by how all the cool kids train their 9000-layered YOLONet-360, we decide to start off with an arbitrary but valid plan and take baby steps to improve it from there. So how do we go about doing that? Maybe the following sub-optimal plan will give us some ideas:</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/cycle_metric.jpg" style="width:35%;" /><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/cycle_plan.png" style="width:35%;" /></center><p>The first figure here with the dotted lines represents $d(x, y)$, since not all metric functions can be mapped to the 2D plane and I wanted to keep the distances rational. The second one represents the plan like in the previous example.</p><p>Suppose we decide that $D$ is too far from $A$, so we want to try to reroute some mass $m$ out of the $0.2$ being transferred from $A$ to $D$. If we subtract $m$ from $\gamma(A, D)$, $C(\gamma)$ changes by $-3m$. But now $A$ has an excess of $m$ and $D$ has a deficit. To get rid of the excess in $A$, let’s say we push it from $A$ to $B$, costing us $2m$. Now that $B$ gets this extra mass from $A$, $C$ can decrease the $0.4$ units of mass it sends out to $B$ to $0.4-m$, decreasing the total cost by $3m$. Finally, $C$ can send over the excess $m$ to $D$ removing its deficit and adding $2m$ to the cost. In graphical form:</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/cycle_apply.gif" style="width:40%;" /></center><p>This cyclical sequence of operations retains the validity of the plan. After all, all we’ve done is reroute some mass $m$ from $D$ back to $D$. The total change in the cost induced by it comes out to be $(-3 + 2 - 3 + 2)m = -2m$. We would therefore like to reroute as much mass as possible through this cycle. So what is the maximum mass we can reroute? The first and the third operation in the cycle involve subtracting mass from transfers present in the original plan. Since we cannot make $\gamma$ negative, the optimal value of $m$ becomes $\min \{\gamma(A, D), \gamma(C, B)\} = 0.2$, and the new plan becomes:</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/final_plan.png" style="width:40%;" /></center><p>It’s easy to verify that the new plan is valid, and the cost of the new plan is $0.4$ less than the original plan.</p><p>In general, if from our original plan, we pick a list of $n$ non-zero transfers \(x_1\Longrightarrow x_2, x_3 \Longrightarrow x_4, \ldots, x_{2n - 1} \Longrightarrow x_{2n}\)</p><p>we can formulate a new, valid plan by rerouting some mass $m \leq \min \{\gamma(x_1, x_2), \ldots, \gamma(x_{2n-1}, x_{2n})\}$ through the cycle. In terms of the plan, this would result in $2n$ changes:</p>\[\begin{aligned} \gamma'(x_1, x_2) =&amp; \gamma(x_1, x_2) - m\\ \gamma'(x_1, x_4) =&amp; \gamma(x_1, x_4) + m\\ \gamma'(x_3, x_4) =&amp; \gamma(x_3, x_4) - m\\ \gamma'(x_3, x_6) =&amp; \gamma(x_3, x_6) + m\\ \vdots\\ \gamma'(x_{2n-1}, x_{2n}) =&amp; \gamma(x_{2n-1}, x_{2n}) - m\\ \gamma'(x_{2n-1}, x_2) =&amp; \gamma(x_{2n-1}, x_2) + m \end{aligned}\]<p>The idea is that for two consecutive transfers $x\Longrightarrow y$ and $a \Longrightarrow b$ in the list, we send $m$ units from $x$ to $b$ instead of $x$ to $y$. We do so sequentially for all the members of the list, and finally we send $m$ units from $x_{2n-1}$ to $x_2$ instead of $x_{2n}$, completing the cycle and reestablishing the validity of the plan (it’s fairly easy to show algebraically that the new plan honors the validity constraints). The total change in cost would then be given by:</p>\[C_d(\gamma') - C_d(\gamma) = m \cdot (-d(x_1, x_2) + d(x_1, x_4)\ldots - d(x_{2n-1}, x_{2n}) + d(x_{2n-1}, x_2))\\\]<p>Now I know that the indexing is a bit wonky and the cyclic nature doesn’t pop out immediately. It’s better to write this as (recall that $d$ is symmetric):</p>\[\Delta C_d = m \cdot (-d(x_2, x_1) + d(x_1, x_4) - d(x_4, x3) \ldots -d(x_{2n}, x_{2n-1}) + d(x_{2n-1}, x_2))\]<p>Which nicely showcases the cycle that follows the propagation as \(x_2\rightarrow x_1\rightarrow x_4\rightarrow x_3\rightarrow x_6\rightarrow x_5 \ldots x_{2n} \rightarrow x_{2n-1} \rightarrow x_{2}\)</p><p>This cycle has a negative edge $x \rightarrow y$ if there is a transfer $y \Longrightarrow x$ and a positive edge otherwise. Notice the reversal in the order of $x$ and $y$.</p><p>Just to drive the point home, in our small example the list of non-zero transfers we considered was:</p>\[A \Longrightarrow D, C \Longrightarrow B\]<p>Notice that the non-zero transfer $A \Longrightarrow B$ was not necessary for our operation. We then changed the plan as:</p>\[\begin{aligned} \gamma'(A, D) &amp;= \gamma(A, D) - m\\ \gamma'(A, B) &amp;= \gamma(D, C) + m\\ \gamma'(C, B) &amp;= \gamma(C, B) - m\\ \gamma'(C, D) &amp;= \gamma(C, D) + m\\ \end{aligned}\]<p>The cycle in our case was $D \rightarrow A \rightarrow B \rightarrow C \rightarrow D$, and the change in cost was:</p>\[\begin{aligned} \Delta C_d &amp;= m \cdot (-d(D, A) + d(A, B) - d(B, C) + d(C, D))\\ &amp;= -2m \end{aligned}\]<p>As we did in our example, we would like to find a cycle which yields a negative total cost and then reroute the maximum possible mass $m = \min \{\gamma(x_1, x_2), \ldots, \gamma(x_{2n-1}, x_{2n})\}$ through it.</p><p>To do so, we can construct a complete graph which has negative edges from $x$ to $y$ with weight $-d(x, y)$ if $\gamma(y, x) &gt; 0$, and positive edges in all other cases with weight $d(x, y)$. We can then find negative cycles in such a graph and reroute some mass $m$ through them, decreasing the total cost. Notice how we haven’t picked a specific list of transfers here to form our negative edges, and have instead constructed the graph using <em>all</em> the available positive transfers. Indeed, a negative cycle in such a graph may have more than one consecutive negative edges. However, this won’t hurt us and using such cycles would still lead to a valid plan (why?). Borrowing some notation from max-flow/min-cut problems, let’s call this graph the <em>residual</em> graph of $\gamma$.</p><p>More concretely, the residual graph $G(\gamma)$ of a plan $\gamma$ can be defined as a complete, directed weighted graph on $\mathcal C$:</p>\[\begin{aligned} G(\gamma) &amp;= (\mathcal C, E, w)\\ E &amp;= \mathcal C \times \mathcal C\\ w(c_i, c_j) &amp;= \begin{cases} -d(c_i, c_j)&amp;\gamma(c_j, c_i) &gt; 0\\ d(c_i, c_j)&amp;\gamma(c_j, c_i) = 0 \end{cases} \end{aligned}\]<p>The residual graph corresponding to the original plan is shown below. We can clearly see the negative cycle $D \rightarrow A \rightarrow B \rightarrow C \rightarrow D$ that we found earlier.</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/residual_graph.png" style="width:40%;" /></center><p>There is a subtlety here. In contrast to what was stated about more than one consecutive negative edges, applying a negative cycle in this residual graph may not lead to a valid plan if there are more than one consecutive <em>positive</em> edges (the values for $d$ in the example are implicitly defined in the residual):</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/bad_neg_cycle_plan.jpg" style="width:35%;" /><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/bad_neg_cycle_residual.png" style="width:35%;" /></center><p>Consider the negative cycle $C \rightarrow A \rightarrow B \rightarrow D \rightarrow C$. Unfortunately, since $D$ originally had $0$ mass, we cannot transfer any mass from $D$ to $C$ even though $D$ would be receiving the same amount of mass from $B$.</p><p>Clearly, the cycle strategy assumes that even if a node doesn’t have mass $m$ to spare, it can still send it out if it is receiving $m$ from another node, going against what we decided when formulating the problem. The negative edges don’t face this issue since they’re just returning some mass that was already being sent out in the original plan; the problem can only potentially occur when we have two (or more) consecutive positive edges in our cycle.</p><p>Thankfully, if we ever find such a cycle, we can always construct an equal or smaller (and therefore, still negative) cycle without the issue. Given a sequence of positive edges $s_0 \rightarrow s_1 \rightarrow s_2 \rightarrow \ldots \rightarrow s_n$, we can replace it with the edge $s_0 \rightarrow s_n$, which exists since our residual graph is complete. The weight of this edge can be $-d(s_0, s_n)$ or $d(s_0, s_n)$. If it’s the former, it’s obviously less than the sum of the original edges which were positive. If it’s the latter, it’s still less than the original by the (repeated application of) triangle inequality. In this example, we simply replace the two edge $B \rightarrow D \rightarrow C$ with a single, direct edge $B \rightarrow C$, giving us the proper, applicable negative cycle $C \rightarrow A \rightarrow B \rightarrow C$.</p><p>This lengthy discussion has shown us that if we find a negative cycle in the residual graph, we can improve the plan using it. It may require some preprocessing before application as mentioned in the previous paragraph, but it will always improve the plan. Therefore, we know that the optimal plan must have <em>no</em> negative cycles in its residual. In other words, the absence of negative cycles in $G(\gamma)$ is a <em>necessary</em> condition for the optimality of $\gamma$. But we can’t say, based on what we’ve seen so far, whether it is also sufficient. What if it was possible to reduce the cost incurred by a plan by radically changing it, even if there were no negative cycles? That is, what if we were in a “local minimum” of sorts? Spoiler alert: the condition is indeed sufficient, and the Kantorovich-Rubinstein dual in the next section will help us prove this.</p><h2 id="the-kantorovich-rubinstein-dual">The Kantorovich-Rubinstein dual</h2><p>It takes us three days and seventeen hours, but we eventually come up with a plan which has no negative cycles. We still don’t know whether such a plan is optimal or not, but at this point, we’re far too sleep deprived to do anything about it. Right as we are about to send over the potentially suboptimal plan to Reeves, we’re approached by Kenny the Ripper and his ragtag band of bandits with an offer to undercut the current contractors. To that end, they propose an alternative pricing scheme wherein instead of charging us in proportion to the distance traveled, they would charge us based on the starting and the ending point of a trip. Each city $c$ is assigned a particular “potential” $\phi(c)$ and transporting a mass $m$ from city $c_i$ to $c_j$ would cost $m \cdot(\phi(c_j) - \phi(c_i))$. The total cost therefore becomes:</p>\[\begin{aligned} L(\phi, \gamma) &amp;= \sum_{c_i, c_j \in \mathcal C}\gamma(c_i, c_j) (\phi(c_j) - \phi(c_i))\\ &amp;= \mathbb{E}_{c_i, c_j \sim \gamma}[\phi(c_j) - \phi(c_i)]\\ &amp;= \mathbb{E}_{c_j \sim q}[\phi(c_j)] - \mathbb{E}_{c_i \sim p}[\phi(c_i)] \end{aligned}\]<p>where the last step follows from the marginalization constraints on $\gamma$. This shows us that $L$ does not depend on the plan $\gamma$ at all! We can therefore write it as $L_{p, q}(\phi)$, solely a function of the potential $\phi$. The subscript ${p, q}$ ties the total cost calculated to the two distributions for the two expectation terms.</p><p>The catch is that <em>they</em> get to decide the values for $\phi$. Being a part of a capitalist society, they would like to <em>maximize</em> the total cost incurred by us, and the optimization problem can now be looked at from their perspective. They, however, assure us that the differences in the values of $\phi$ would never exceed the distances among the cities:</p>\[\forall c_i, c_j \in \mathcal C\, \phi(c_j) - \phi(c_i) \leq d(c_i, c_j)\]<p>Let’s call the set of potentials that honor this constraint given the metric $d$ as $\Phi_{d}$. Notice how this constraint immediately implies that regardless of the choice of $\phi$, $L_{p, q}$ for a given $\gamma$ would always be less than or equal to $C_{d}(\gamma)$:</p>\[\begin{aligned} \mathbb{E}_{c_j \sim q}[\phi(c_j)] - \mathbb{E}_{c_i \sim p}[\phi(c_i)] &amp;= \mathbb{E}_{c_i, c_j \sim \gamma} [\phi(c_j) - \phi(c_i)]\\ &amp;\leq \mathbb{E}_{c_i, c_j \sim \gamma} [d(c_i, c_j)]\\ &amp;= C_d(\gamma) \end{aligned}\]<p>This inequality doesn’t depend on the $\gamma$ in question as long as the plan and the potential is valid. Therefore, we can say:</p>\[\begin{aligned} \forall \phi \in \Phi_d\forall \gamma \in \Gamma_{p, q} \,L_{p, q}(\phi) \leq C_{d}(\gamma)\\ \implies \max_{\phi \in \Phi_d} L_{p, q}(\phi) \leq \min_{\gamma \in \Gamma_{p, q}}C_d(\gamma) \end{aligned}\]<p>The right hand side of the inequality is nothing but the primal form of $W(p, q)$, so it is <em>always</em> in our best interest to to take up Kenny’s offer. The left hand side, which Kenny needs to solve, is the Kantorovich-Rubinstein dual. The subscripts on the constraints and the cost functions explicitly showcase the duality. This inequality can be visually represented as:</p><center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="../../assets/images/2020-05-28-wasserstein/duality_gap.png" style="width:40%;" /></center><p>We don’t know if the gap between $L_{p, q}(\phi^*)$ and $C_d(\gamma^*)$ is zero or not. If only we could find <em>any</em> transportation plan and <em>any</em> potential function that produce the same value for the primal and the dual respectively, we would’ve shown:</p><ul><li>The found plan is optimal for the primal.<li>The found potential function is optimal for the dual.<li>The duality is strong so both the formulations are equivalent.</ul><p>Indeed, we’ll start with a valid plan $\gamma’$ with the sole property that $G(\gamma’)$ has no negative cycles and construct an equivalent potential function, proving a fourth point:</p><ul><li>The absence of negative cycles in $G(\gamma)$ is both necessary <em>and sufficient</em> for the optimality of $\gamma$.</ul><p>The thing to notice is that if we rearrange the constraints a bit:</p>\[\forall c_i, c_j \in \mathcal C\,\phi(c_j) \leq \phi(c_i) + d(c_i, c_j)\]<p>it looks like something straight out of a <a href="https://en.wikipedia.org/wiki/Bellman%E2%80%93Ford_algorithm">shortest-path algorithm</a>. In a directed weighted graph, the length of the shortest path from a node $A$ to a node $B$, let’s call it $l_A(B)$, must be less than or equal to the length from $A$ to another node $C$ ($l_A(C)$) plus the weight of the edge from $C$ to $B$. That is:</p>\[l_A(B) \leq l_A(C) + w(C, B)\]<p>This is because if it weren’t, we could first go from $A$ to $C$ and then follow the edge from $C$ to $B$ and we will get a path shorter than the shortest path. Of course, in the case of $G(\gamma’)$, $w(c_i, c_j)$ may not be equal to $d(c_i, c_j)$ but we’ll come to that in a bit. Also, it seems awfully suspicious that the necessary condition for optimality that we found in the previous section was the absence of negative cycles, which is precisely the condition required to guarantee the existence of finite shortest paths. After all, if while looking for a shortest path between two nodes in a graph we were to encounter a negative cycle, we could traverse that cycle an arbitrary number of times and decrease the path length to $-\infty$.</p><p>Running with this hint, we define $\phi_{\gamma’}(c_i)$ to be the length of the shortest path between $c_0$ and $c_i$ in $G(\gamma’)$, where the choice of $c_0$ is arbitrary. As mentioned previously, this is a finite value for all $c_i$ since we are working with a complete graph with no negative cycles. By the Bellman-Ford equation from earlier, we see that:</p>\[\begin{aligned} \phi_{\gamma'}(c_i) - \phi_{\gamma'}(c_j) &amp;\leq w(c_j, c_i)\\ &amp;\leq d(c_i, c_j) \end{aligned}\]<p>where the second inequality comes from the fact that $w(c_j, c_i)$ can either be $d(c_i, c_j)$ or $-d(c_i, c_j)$. So, the $\phi_{\gamma’}$ described in this manner belongs to the valid set $\Phi_d$. All that’s left is to show that $C_d(\gamma’) = L_{p, q}(\phi_{\gamma’})$. If we take a look again at how we formulated the dual problem:</p>\[\sum_{c_i, c_j \in \mathcal C}\gamma'(c_i, c_j) (\phi_{\gamma'}(c_j) - \phi_{\gamma'}(c_i))\\\]<p>we can see that if $\phi(c_j) - \phi(c_i) = d(c_i, c_j)$ wherever $\gamma’(c_i, c_j) &gt; 0$, the sum would essentially boil down to:</p>\[\sum_{c_i, c_j \in \mathcal C}\gamma'(c_i, c_j)d(c_i, c_j) = C_d(\gamma')\]<p>We will now show this by contradiction. First, we recall by the definition of $G(\gamma’)$ that $\gamma’(c_i, c_j) &gt; 0$ implies $w(c_j, c_i) = -d(c_i, c_j)$. Now we assume the opposite of what we want to show: $\phi(c_j) - \phi(c_i) \neq d(c_i, c_j)$ for some $c_i, c_j$ where $\gamma’(c_i, c_j) &gt; 0$. Note that as we showed above, $\phi(c_j) - \phi(c_i)$ can’t be greater than $d(c_i, c_j)$, so under our assumption, it must be $&lt; d(c_i, c_j)$. So our assumption is:</p>\[\exists c_i, c_j \in \mathcal C \text{ s.t. } \gamma'(c_i, c_j) &gt; 0 \text{ and }\phi_{\gamma'}(c_j) - d(c_i, c_j) &lt; \phi_{\gamma'}(c_i)\]<p>Let $c_x, c_y$ be one such pair that follows this inequality. If we were to move from $c_0$ to $c_y$ along the shortest route, and then move to $c_x$ along the edge $c_y \rightarrow c_x$, which has a weight of $-d(c_x, c_y)$, the total length of the path would be $\phi_{\gamma’}(c_y) - d(c_x, c_y)$ which is then less than $\phi_{\gamma’}(c_x)$ by our assumption. But this raises a contradiction to the definition of $\phi_{\gamma’}(c_i)$ as the length of the shortest path from $c_0$ to $c_i$, so our assumption must be flawed. That is, $\gamma’(c_i, c_j) &gt; 0$ <em>must</em> imply $\phi(c_j) - \phi(c_i) = d(c_i, c_j)$. This, in turn, proves the equality:</p>\[P_{p, q}(\phi_{\gamma'}) = C_d(\gamma')\]<p>for any $\gamma’ \in \Gamma_{p, q}$ such that $G(\gamma’)$ has no negative cycles. This result itself then proves the list of things that were mentioned above, finally concluding our quest.</p><p><strong>P.S.</strong> This discussion doesn’t show whether the algorithm of repeatedly eliminating negative cycles terminates or not. That’s a story for some other time (or maybe not). For today, I think we’ve had enough of potentials and plans.</p><h2 id="references">References</h2><ol class="bibliography"><li><span id="arjovsky2017wasserstein"><span style="font-variant: small-caps">Arjovsky, M., Chintala, S., and Bottou, L.</span> 2017. Wasserstein gan. <i>arXiv preprint arXiv:1701.07875</i>.</span><li><span id="kantorovich1942translocation"><span style="font-variant: small-caps">Kantorovich, L.V.</span> 1942. On the translocation of masses. <i>Dokl. Akad. Nauk. USSR (NS)</i>, 199–201.</span><li><span id="villani2008optimal"><span style="font-variant: small-caps">Villani, C.</span> 2008. <i>Optimal transport: old and new</i>. Springer Science &amp; Business Media.</span></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/math/'>Math</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/duality/" class="post-tag no-text-decoration" >duality</a> <a href="/tags/wasserstein/" class="post-tag no-text-decoration" >wasserstein</a> <a href="/tags/kantorovich/" class="post-tag no-text-decoration" >kantorovich</a> <a href="/tags/rubinstein/" class="post-tag no-text-decoration" >rubinstein</a> <a href="/tags/gan/" class="post-tag no-text-decoration" >gan</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=The Kantorovich-Rubinstein duality - VanillaBug&url=https://many-facedgod.github.io/posts/wasserstein/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=The Kantorovich-Rubinstein duality - VanillaBug&u=https://many-facedgod.github.io/posts/wasserstein/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=The Kantorovich-Rubinstein duality - VanillaBug&url=https://many-facedgod.github.io/posts/wasserstein/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://many-facedgod.github.io/posts/wasserstein/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/lets-count/"><div class="card-body"> <span class="timeago small" > Apr 21, 2020 <i class="unloaded">2020-04-21T13:19:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Let's Count!</h3><div class="text-muted small"><p> For my first post, let’s talk about the simplest thing I could think of. It’s something so innate to our intuition, that we might as well call it… natural. You guessed it, today we’ll talk about na...</p></div></div></a></div><div class="card"> <a href="/posts/git-init/"><div class="card-body"> <span class="timeago small" > Apr 19, 2020 <i class="unloaded">2020-04-19T03:52:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>git init</h3><div class="text-muted small"><p> Freshly graduated with a master’s degree in computer science and basking in the newly discovered privilege of not having seventeen and a half deadlines every week, I’ve decided to try my hand at no...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/lets-count/" class="btn btn-outline-primary"><p>Let's Count!</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/many-facedgod">Tanmaya Shekhar Dabral</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/countability/">countability</a> <a class="post-tag" href="/tags/duality/">duality</a> <a class="post-tag" href="/tags/gan/">gan</a> <a class="post-tag" href="/tags/introduction/">introduction</a> <a class="post-tag" href="/tags/kantorovich/">kantorovich</a> <a class="post-tag" href="/tags/natural-numbers/">natural numbers</a> <a class="post-tag" href="/tags/rubinstein/">rubinstein</a> <a class="post-tag" href="/tags/uncountability/">uncountability</a> <a class="post-tag" href="/tags/wasserstein/">wasserstein</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://many-facedgod.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); </script>
